@model CartViewModel
@using System.Globalization
@{
    ViewData["Title"] = "Index";
}

<section id="cart_Model.Cart[i]s">
    <div class="container">
        <div class="breadcrumbs">
            <ol class="breadcrumb">
                <li><a href="#">Home</a></li>
                <li class="active">Shopping Cart</li>
            </ol>
        </div>
        @if (Model.Cart == null)
        {
            <p>Giỏ hàng trống</p>
        }
        else
        {
    <div class="table-responsive cart_info">
        <form asp-action="CheckOut">
            <table class="table table-condensed">
                <thead>
                    <tr class="cart_menu">
                        <td class="image">Model.Cart[i]</td>
                        <td class="description"></td>
                        <td class="price">Price</td>
                        <td class="quantity">Quantity</td>
                        <td class="total">Total</td>
                        <td></td>
                    </tr>
                </thead>
                <tbody>

                    @for(int i=0; i< Model.Cart.Count; i++)
                    {
                        <tr>
                            <td class="cart_product">
                                <a href=""><img src="@Model.Cart[i].Product.Image" alt="" height="50" width="50"></a>
                            </td>
                            <td class="cart_description">
                                <h4><a href="">@Model.Cart[i].Product.Name</a></h4>
                                <p>Web ID: @Model.Cart[i].Product.Id</p>
                            </td>
                            <td class="cart_price">
                                <p class="cart_unit_@Model.Cart[i].Id">@Model.Cart[i].Product.Price</p>
                            </td>
                            <td class="cart_quantity">
                                <div class="cart_quantity_button">
                                    @*<a class="cart_quantity_up" href=""> + </a>*@
                                    <input class="cart_quantity_input" id="@Model.Cart[i].Id" type="text" asp-for="@Model.Cart[i].Quantity" value="@Model.Cart[i].Quantity" autocomplete="off" size="3">
                                    <input type="hidden" asp-for="@Model.Cart[i].Product.Id">
                                    <input type="hidden" asp-for="@Model.Cart[i].Id">
                                    @*<a class="cart_quantity_down" href=""> - </a>*@
                                </div>
                            </td>
                            <td class="cart_total">
                                <p class="cart_total_@Model.Cart[i].Id">@(Model.Cart[i].Product.Price * Model.Cart[i].Quantity)</p>
                            </td>
                            <td class="cart_delete">
                                <a class="cart_quantity_delete" asp-action="Remove" asp-controller="Cart" asp-route-id="@Model.Cart[i].Product.Id"><i class="fa fa-times"></i></a>
                            </td>
                        </tr>
                    }
                <tr>
                    <td align="right" colspan="4">Sum</td>
                    <td class="cart_sum">
                        @Model.Total
                    </td>
                    <input type="hidden" asp-for="@Model.Total">
                </tr>

                </tbody>
            </table>
            <div class="col-sm-6">
                <button type="submit" class="btn btn-default check_out">Check Out</button>
            </div>




        </form>
    </div>
        }

    </div>
</section>

@section scripts {
<script type="text/javascript">
    $(document).ready(function(){
    
        $('input.cart_quantity_input').on("change keyup paste", function () {
            var thisID = $(this).attr('id');
            var quantity = parseFloat($(this).val());
            var price = parseFloat($('p.cart_unit_' + thisID).text());
            $('.cart_total_' + thisID).text(quantity * price);
            var total = 0;
            $('td.cart_total').each(function (index) {
                total = total + parseFloat($(this).find('p').text());
            })
            $('td.cart_sum').text(total);
         })
        })
</script>

}
